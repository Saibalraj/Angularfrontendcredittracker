<div class="dashboard">
  <div class="dashboard-header">
    <h2>Welcome, {{ studentName }}</h2>
    <div class="header-actions">
      <button class="outline" (click)="refreshData()">Refresh</button>
      <button class="logout-btn" (click)="logout()">Logout</button>
    </div>
  </div>

    <div class="semester-selector">
    <select [(ngModel)]="selectedAdminSemesterId">
      <option [value]="1">Semester 1</option>
      <option [value]="2">Semester 2</option>
      <option [value]="3">Semester 3</option>
      <option [value]="4">Semester 4</option>
      <option [value]="5">Semester 5</option>
      <option [value]="6">Semester 6</option>
    </select>
  </div>

  <div class="credit-status">
      <div class="credit-info">
        <span>Semester Credits: {{ getSemesterCredits(selectedAdminCourseId, selectedAdminSemesterId) }} / 36</span>
        <span *ngIf="isSemesterFull(selectedAdminCourseId, selectedAdminSemesterId)" class="status approved">your credit is full</span>
        <span *ngIf="!isSemesterFull(selectedAdminCourseId, selectedAdminSemesterId)" class="status pending">your credit is not full</span>
      </div>
      <div class="credit-info">
        <span>Total Credits: {{ getTotalCredits() }} / 216</span>
        <span *ngIf="isCourseFull()" class="status approved">your credit is full</span>
        <span *ngIf="!isCourseFull()" class="status pending">your credit is not full</span>
      </div>
    </div>


  <section class="subjects">
    <div class="subjects-header">
      <h3>Available Subjects</h3>
      <button class="outline" (click)="exportMyApplications()">Export Applications</button>
    </div>

    <div *ngIf="getAdminCourseSubjects(selectedAdminCourseId, selectedAdminSemesterId).length === 0" class="empty-state">
      No subjects available for this semester
    </div>

    <ul>
      <li *ngFor="let sub of getAdminCourseSubjects(selectedAdminCourseId, selectedAdminSemesterId)">
        <div class="sub-row">
          <div class="sub-meta">
            <strong>{{ sub.name }}</strong>
            <div class="subject-details">
              <small class="credits">{{ sub?.credits || 0 }} credits</small>
              <span *ngIf="sub.isElective" class="elective-badge">Elective</span>
            </div>
          </div>
          <div class="sub-actions">
            <button (click)="applyForSubject(sub)"
                    [disabled]="getApplicationStatus(sub) === 'pending' || getApplicationStatus(sub) === 'approved' || isSemesterFull(selectedAdminCourseId, selectedAdminSemesterId)"
                    [title]="isSemesterFull(selectedAdminCourseId, selectedAdminSemesterId) ? 'Semester credits are full' : ''">
              Apply
            </button>
            <span *ngIf="getApplicationStatus(sub) === 'pending'" class="status pending">Pending</span>
            <span *ngIf="getApplicationStatus(sub) === 'approved'" class="status approved">Approved</span>
            <span *ngIf="getApplicationStatus(sub) === 'rejected'" class="status rejected">Rejected</span>
          </div>
        </div>
      </li>
    </ul>
  </section>
</div>

<app-toast></app-toast>
